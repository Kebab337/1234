<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Понг</title>
    <style>
        body {
           
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: #222;
            overflow: hidden; /* Предотвращаем полосы прокрутки */
        }

        canvas {
            background-color: #000;
            cursor: none; /* Скрыть курсор */
        }

        #score {
            position: absolute;
            top: 10px;
            font-size: 2em;
            color: white;
        }
    </style>
</head>
<body>
    <div id="score">
        <span id="playerScore">0</span>:<span id="computerScore">0</span>
    </div>
    <canvas id="pongCanvas" width="800" height="600"></canvas>

    <script>
        const canvas = document.getElementById('pongCanvas');
        const ctx = canvas.getContext('2d');

        const playerScoreDisplay = document.getElementById('playerScore');
        const computerScoreDisplay = document.getElementById('computerScore');

        const paddleWidth = 10;
        const paddleHeight = 60;
        const ballSize = 10;
        const speed = 8;
        const smoothSpeed = 0.1; // Коэффициент сглаживания

        let playerY = canvas.height / 2 - paddleHeight / 2;
        let computerY = canvas.height / 2 - paddleHeight / 2;
        let computerTargetY = computerY; // Целевая позиция компьютерной ракетки
        let ballX = canvas.width / 2;
        let ballY = canvas.height / 2;
        let ballSpeedX = speed;
        let ballSpeedY = speed;
        let playerScore = 0;
        let computerScore = 0;
        let playerVelocity = 0; // Скорость для стрелок
        let gameStarted = false;

        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Рисуем ракетки
            ctx.fillStyle = '#fff';
            ctx.fillRect(10, playerY, paddleWidth, paddleHeight); // ракетка игрока
            ctx.fillRect(canvas.width - 10 - paddleWidth, computerY, paddleWidth, paddleHeight); // ракетка комп.

            // Рисуем мяч
            ctx.beginPath();
            ctx.arc(ballX, ballY, ballSize, 0, Math.PI * 2);
            ctx.fill();

            playerScoreDisplay.textContent = playerScore;
            computerScoreDisplay.textContent = computerScore;
        }

        function update() {
            if (!gameStarted) return;
            // Движение мяча
            ballX += ballSpeedX;
            ballY += ballSpeedY;

            // Отскок от верха и низа
            if (ballY + ballSize > canvas.height || ballY - ballSize < 0) {
                ballSpeedY = -ballSpeedY;
            }


            // Управление компьютером
            computerTargetY = ballY - paddleHeight / 2;
            computerY += (computerTargetY - computerY) * smoothSpeed;

            // Ограничения движения ракетки компьютера
            if (computerY < 0) {
                computerY = 0;
            } else if (computerY + paddleHeight > canvas.height) {
                computerY = canvas.height - paddleHeight;
            }

            // Движение ракетки игрока
            playerY += playerVelocity;
            // Ограничения движения ракетки игрока
            if (playerY < 0) {
                playerY = 0;
            } else if (playerY + paddleHeight > canvas.height) {
                playerY = canvas.height - paddleHeight;
            }


            // Проверка столкновения мяча с ракетками
            if (ballX - ballSize < 10 + paddleWidth && ballY > playerY && ballY < playerY + paddleHeight) {
                ballSpeedX = -ballSpeedX;
            }
            if (ballX + ballSize > canvas.width - 10 - paddleWidth && ballY > computerY && ballY < computerY + paddleHeight) {
                ballSpeedX = -ballSpeedX;
            }
            // Проверка на гол
            if (ballX - ballSize < 0) {
                resetBall();
                computerScore++;
                console.log("Computer scores");
            }
            if (ballX + ballSize > canvas.width) {
                resetBall();
                playerScore++;
                console.log("Player scores");
            }
        }

        function resetBall() {
            ballX = canvas.width / 2;
            ballY = canvas.height / 2;
            ballSpeedX = Math.random() > 0.5 ? speed : -speed; // Случайное направление
            ballSpeedY = (Math.random() - 0.5) * speed; // Случайный угол
        }

        function gameLoop() {
            update();
            draw();
            requestAnimationFrame(gameLoop);
        }


        // Управление стрелками
        document.addEventListener('keydown', (e) => {
            gameStarted = true;
            if (e.key === 'ArrowUp') {
                playerVelocity = -speed;
            } else if (e.key === 'ArrowDown') {
                playerVelocity = speed;
            }
        });

        document.addEventListener('keyup', (e) => {
            if (e.key === 'ArrowUp' || e.key === 'ArrowDown') {
                playerVelocity = 0;
            }
        });

        resetBall();
        gameLoop();
    </script>
</body>
</html>